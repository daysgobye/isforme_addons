<script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.36.0/ace.js"
    integrity="sha512-TR97DMS7l/aiCHcIrwJhxxwOZaweN3eIV0LBr0ZKwtDAg2czUT7J9HGgYecG8UjesBCwMLkS71GQTmsGkY18Kw=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<link href="
https://cdn.jsdelivr.net/npm/ace-builds@1.36.0/css/ace.min.css
" rel="stylesheet">

<style type="text/css" media="screen">
    dialog[open] {
        display: flex;
        flex-direction: column;
    }

    #editor-open {}

    #editor {
        width: 100%;
        height: 90%;
    }

    .editor-controlls {
        display: flex;
    }
</style>






<dialog>
    <div class="editor-controlls">
        <select name="editor language" aria-label="Select your editor language">
            <option selected disabled value="">
                language option
            </option>
            <option>html</option>
            <option>markdown</option>
            <option>css</option>
        </select>
        <button autofocus>Close</button>
    </div>
    <div id="editor">
    </div>
    <form id="editor-submit">
        <input type="submit" value="save" />
    </form>

</dialog>
<!-- <button id="editor-open">Show the dialog</button> -->


<script>
    let writePw = ""

    const { origin, pathname } = window.location
    // fetch(`${origin}/api/raw${pathname}`)
    const dialog = document.querySelector("dialog");
    const showButton = document.getElementById("editor-open");
    const closeButton = document.querySelector("dialog button");
    const languageChange = document.querySelector("dialog select");
    const fourm = document.getElementById("editor-submit");
    const editor = ace.edit("editor");

    window.spaceSettings.editor = {
        title: "editor write password",
        fieldType: "string",
        description: "open the full page editor",
        value: writePw,
        onSave: (newValue) => {
            writePw = newValue
            dialog.showModal();

        }
    }
    fourm.addEventListener("submit", (e) => {
        e.preventDefault();
        const writepw = document.querySelector("#editor-submit writepw");
        console.log(writepw)
        dialog.close();

    });
    // // "Show the dialog" button opens the dialog modally
    // showButton.addEventListener("click", () => {
    // });
    // "Close" button closes the dialog
    closeButton.addEventListener("click", () => {
        dialog.close();
    });
    languageChange.addEventListener("change", () => {
        console.log(languageChange.value)
        editor.session.setMode(`ace/mode/${languageChange.value}`);
    })


    editor.setTheme("ace/theme/monokai");
    editor.session.setMode("ace/mode/html");
</script>