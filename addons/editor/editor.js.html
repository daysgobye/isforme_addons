<script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.36.0/ace.js"
    integrity="sha512-TR97DMS7l/aiCHcIrwJhxxwOZaweN3eIV0LBr0ZKwtDAg2czUT7J9HGgYecG8UjesBCwMLkS71GQTmsGkY18Kw=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<link href="
https://cdn.jsdelivr.net/npm/ace-builds@1.36.0/css/ace.min.css
" rel="stylesheet">

<style type="text/css" media="screen">
    dialog[open] {
        display: flex;
        flex-direction: column;
    }

    #editor-open {}

    #editor {
        width: 100%;
        height: 90%;
    }

    .editor-controlls {
        display: flex;
    }
</style>






<dialog>
    <div class="editor-controlls">
        <select name="editor language" aria-label="Select your editor language">
            <option selected disabled value="">
                language option
            </option>
            <option>html</option>
            <option>markdown</option>
            <option>css</option>
        </select>
        <button autofocus>Close</button>
    </div>
    <div id="editor">
    </div>
    <form id="editor-submit">
        <input type="password" name="password" placeholder="Write Password" id="editor-writepw" />
        <input type="submit" value="save" />
    </form>
</dialog>

<script>
    let readPw = ""

    const onOpen = (readPw) => {
        readPw
        dialog.showModal();
        // fetch(`${origin}/api/raw${pathname}`)

    }

    const { origin, pathname } = window.location
    const dialog = document.querySelector("dialog");
    const showButton = document.getElementById("editor-open");
    const closeButton = document.querySelector("dialog button");
    const languageChange = document.querySelector("dialog select");
    const fourm = document.getElementById("editor-submit");
    const editor = ace.edit("editor");

    window.spaceSettings.editor = {
        title: "Open Editor Read Password",
        fieldType: "string",
        description: "Open the full page editor",
        savebtnText: "Open",
        value: readPw,
        onSave: (newValue) => {
            onOpen(newValue)
        }
    }

    fourm.addEventListener("submit", (e) => {
        const writepw = document.getElementById("editor-writepw").value
        e.preventDefault();
        console.log(writepw)
        dialog.close();

    });

    closeButton.addEventListener("click", () => {
        dialog.close();
    });
    languageChange.addEventListener("change", () => {
        console.log(languageChange.value)
        editor.session.setMode(`ace/mode/${languageChange.value}`);
    })


    editor.setTheme("ace/theme/monokai");
    editor.session.setMode("ace/mode/html");
</script>